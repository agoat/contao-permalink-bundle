services:
    _instanceof:
        Agoat\PermalinkBundle\Permalink\PermalinkHandlerInterface:
            tags:
                - { name: permalink.handler }

    contao.permalink.route_provider:
        class: Agoat\PermalinkBundle\Routing\RouteProvider
        decorates: contao.routing.route_provider
        arguments:
            - "@contao.framework"

    contao.permalnk.frontend_loader:
        class: Agoat\PermalinkBundle\Routing\FrontendLoader
        decorates: contao.routing.frontend_loader
        public: false
        tags:
            - { name: routing.loader }

    contao.permalink.url_generator:
        class: Agoat\PermalinkBundle\Routing\UrlGenerator
        decorates: contao.routing.url_generator
        arguments:
            - "@router"
            - !tagged_locator { tag: permalink.controller, index_by: context}

    contao.permalink.controller_chain:
        class: Agoat\PermalinkBundle\Controller\ControllerLocator
        public: true

    contao.permalink.controller:
        class: Agoat\PermalinkBundle\Controller\PermalinkController
        arguments:
            - !tagged_locator { tag: permalink.controller, index_by: context}

    Agoat\PermalinkBundle\Controller\PermalinkController:
        alias: contao.permalink.controller
        public: true

    contao.permalink.page_controller:
        class: Agoat\PermalinkBundle\Controller\PagePermalinkController
        public: false
        arguments:
            - "@router"
        tags:
            - { name: permalink.controller, context: page }

    contao.permalink.item_controller:
        class: Agoat\PermalinkBundle\Controller\ItemPermalinkController
        public: false
        tags:
            - { name: permalink.controller, context: item }

    contao.permalink.event_controller:
        class: Agoat\PermalinkBundle\Controller\EventPermalinkController
        public: false
        tags:
            - { name: permalink.controller, context: event }

    contao.permalink.generator:
        class: Agoat\PermalinkBundle\Permalink\PermalinkGenerator
        public: true
        arguments:
            - !tagged { tag: permalink.handler}

    Agoat\PermalinkBundle\Permalink\PermalinkGenerator:
        alias: contao.permalink.generator
        public: true

    contao.permalink.page_handler:
        class: Agoat\PermalinkBundle\Permalink\PagePermalinkHandler
        public: false
        arguments:
            - "@request_stack"
            - "%contao.url_suffix%"

    contao.permalink.item_handler:
        class: Agoat\PermalinkBundle\Permalink\ItemPermalinkHandler
        public: false
        arguments:
            - "@request_stack"
            - "%contao.url_suffix%"

    contao.permalink.event_handler:
        class: Agoat\PermalinkBundle\Permalink\EventPermalinkHandler
        public: false
        arguments:
            - "@request_stack"
            - "%contao.url_suffix%"
